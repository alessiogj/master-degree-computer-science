\chapter{Riduzioni}
\section{Insieme indipendente}
Consideriamo il problema dell'insieme indipendente.
In input disponiamo di un grafo $G = (V,E)$ non diretto e un parametro $k$, e 
in output abbiamo \texttt{yes} se e solo se esiste un insieme indipendente di
cardinalità almeno $k$.

Per indipendente intendiamo un insieme di vertici tale che nessun arco abbia entrambi
i vertici in $I$.

Mostriamo che il problema dell'insieme indipendente è \texttt{NP}-completo, per fare ciò
dobbiamo mostrare che il problema è in \texttt{NP} e che è \texttt{NP-hard}.

\begin{itemize}
    \item \texttt{NP}: Dato un insieme $I$ di vertici, possiamo verificare in tempo polinomiale
    se $I$ è un insieme indipendente. Il certificato è un \textit{indipendent set} $I$ per 
    $G$ di cardinalità almeno $k$, e la verifica consiste nel controllare che nessun arco abbia
    entrambi i vertici in $I$ e che $|I| \geq k$, entrambe le operazioni sono fattibili in tempo
    polinomiale, infatti il controllo viene fatto in tempo $O(|E| \cdot |V|^2)$.
    \item \texttt{NP-hard}: Dimostriamo che $\texttt{3-SAT} \leq \texttt{Indipendent Set}$.
    
    Per farlo dobbiamo mappare una formula $\phi$ in un grafo $G_\phi$ tale che $\phi$ sia soddisfacibile
    se e solo se $G_\phi$ ha un insieme indipendente di cardinalità almeno $k$.

    Consideriamo un formula $\phi$ in forma normale congiuntiva, ovvero una congiunzione di clausole
    $\phi = C_1 \land C_2 \land \ldots \land C_m$, dove ogni clausola è una disgiunzione di letterali
    $C_i = l_{1}^{(i)} \lor l_{2}^{(i)} \lor l_{3}^{(i)}$.

    La riduzione $R$, per ogni $i = 1, \ldots, m$ crea un triangolo nel grafo $G_\phi$ i cui i vertici sono 
    etichettati con i letterali di $C_i$.
    \begin{figure}[H]
        \centering 
        \begin{tikzpicture}[node distance={10mm}, thick,
            main/.style = {draw, circle, minimum size=1cm}]
                \node[main, fill = gray!30] (x1) {$l_1^1$};
                \node[main, fill = gray!30] (x2) [below left=of x1] {$l_2^1$};
                \node[main, fill = gray!30] (x3) [below right=of x1] {$l_3^1$};

                \node[main, fill = gray!30] (x4) [right=of x1, xshift=3cm] {$l_1^2$};
                \node[main, fill = gray!30] (x5) [below left=of x4] {$l_2^2$};
                \node[main, fill = gray!30] (x6) [below right=of x4] {$l_3^2$};

                \node[main, fill = gray!30] (x7) [right=of x4, xshift=3cm] {$l_1^3$};
                \node[main, fill = gray!30] (x8) [below left=of x7] {$l_2^3$};
                \node[main, fill = gray!30] (x9) [below right=of x7] {$l_3^3$};

                \draw (x1) -- (x2);
                \draw (x1) -- (x3);
                \draw (x2) -- (x3);

                \draw (x4) -- (x5);
                \draw (x4) -- (x6);
                \draw (x5) -- (x6);

                \draw (x7) -- (x8);
                \draw (x7) -- (x9);
                \draw (x8) -- (x9);

        \end{tikzpicture}
    \end{figure}
    In un insieme indipendente di $G_\phi$ possiamo selezionare al massimo un vertice per triangolo,
    ovvero possiamo selezionare al massimo un letterale per clausola. Se selezioniamo un letterale
    per clausola, possiamo selezionare un letterale per clausola che renda vera la clausola, in tal
    caso l'insieme indipendente avrà cardinalità $m$.

    Per prima cosa fissiamo $k = m$, in tal caso se $\phi$ è soddisfacibile allora $G_\phi$ ha un insieme
    indipendente di cardinalità $m$.

    Per ogni coppia di vertici di triangoli diversi che corrispondono a letterali opposti, aggiungiamo un
    arco.

    Consideriamo la formula:
    \begin{align*}
        \phi = (x_1 \lor x_2 \lor \overline{x_3}) \land (\overline{x_1} \lor 
        \overline{x_2} \lor x_4) \land (x_1 \lor \overline{x_2} \lor \overline{x_4})
    \end{align*} 
    Ciò corrisponde al grafo:
    \begin{figure}[H]
        \centering 
        \begin{tikzpicture}[node distance={10mm}, thick,
            main/.style = {draw, circle, minimum size=1cm}]
                \node[main, fill = gray!30] (x1) {$x_1$};
                \node[main, fill = gray!30] (x2) [below left=of x1] {$x_2$};
                \node[main, fill = gray!30] (x3) [below right=of x1] {$\overline{x_3}$};

                \node[main, fill = gray!30] (x4) [right=of x1, xshift=3cm] {$\overline{x_1}$};
                \node[main, fill = gray!30] (x5) [below left=of x4] {$\overline{x_2}$};
                \node[main, fill = gray!30] (x6) [below right=of x4] {$x_4$};

                \node[main, fill = gray!30] (x7) [right=of x4, xshift=3cm] {$x_1$};
                \node[main, fill = gray!30] (x8) [below left=of x7] {$\overline{x_2}$};
                \node[main, fill = gray!30] (x9) [below right=of x7] {$\overline{x_4}$};

                \draw (x1) -- (x2);
                \draw (x1) -- (x3);
                \draw (x2) -- (x3);

                \draw (x4) -- (x5);
                \draw (x4) -- (x6);
                \draw (x5) -- (x6);

                \draw (x7) -- (x8);
                \draw (x7) -- (x9);
                \draw (x8) -- (x9);

                \draw (x1) [bend left] to (x4);
                \draw (x4) [bend left] to (x7);
                \draw (x2) [bend right] to (x5);
                \draw (x2) [bend right] to (x8);
                \draw (x6) [bend right] to (x9);
        \end{tikzpicture}
    \end{figure}
    Dobbiamo provare che:
    \begin{enumerate}
        \item Se esiste un assegnamento $a$ che soddisfa $\phi$, allora $G_\phi$ ha un insieme indipendente
        di cardinalità $m$.
        \item Se $G_\phi$ ha un insieme indipendente di cardinalità $m$, allora esiste un assegnamento $a$
        che soddisfa $\phi$.
    \end{enumerate}

    Proviamo il punto 1. Supponiamo che esista un assegnamento $a$ che soddisfa $\phi$, allora per ogni
    $i = 1, \ldots, m$ esiste un letterale $l_{j_i}^{(i)}$ nella clausola $C_i$ tale che $l_j^{(i)}(a) = \texttt{true}$.
    Inoltre, per ogni $i, i'$ $l_j^{(i)} \neq l_j^{(i')}$, ovvero non possiamo selezionare due letterali
    opposti, da questo segue che i vertici corrispondenti ai letterali selezionati non sono adiacenti.

    Proviamo il punto 2. Supponiamo che $G_\phi$ abbia un insieme indipendente di cardinalità $m$, allora
    possiamo selezionare un vertice per triangolo, ovvero possiamo selezionare un letterale per clausola
    in modo che i vertici selezionati non siano adiacenti. Selezioniamo un letterale per clausola che renda
    vera la clausola, in tal caso l'insieme indipendente avrà cardinalità $m$.

    Abbiamo quindi dimostrato che il problema dell'insieme indipendente è \texttt{NP}-completo.
\end{itemize}

\section{Clique di taglia fissata}
Consideriamo il problema della clique di taglia fissata.

In input disponiamo di un grafo $G = (V,E)$ non diretto e un parametro $k$, e in output abbiamo
\texttt{yes} se e solo se esiste una clique di cardinalità almeno $k$.

Per clique intendiamo un insieme di vertici tale che ogni coppia di vertici sia adiacente.

\begin{figure}[H]
    \centering 
    \begin{tikzpicture}[node distance={10mm}, thick,
        main/.style = {draw, circle, minimum size=1cm}]
            \node[main, fill = blue!30] (x1) {};
            \node[main, fill = blue!30] (x2) [below left=of x1] {};
            \node[main, fill = blue!30] (x3) [below right=of x1] {};
            \node[main, fill = blue!30] (x4) [below right=of x2] {};
            \node[main, fill = gray!30] (x5) [below right=of x3] {};
            \node[main, fill = gray!30] (x6) [above right=of x3] {};

            \draw (x1) -- (x2);
            \draw (x1) -- (x3);
            \draw (x2) -- (x3);
            \draw (x2) -- (x4);
            \draw (x3) -- (x5);
            \draw (x3) -- (x6);
            \draw (x1) -- (x4);
            \draw (x4) -- (x3);
    \end{tikzpicture}
    \caption{Esempio di clique di taglia $4$}
\end{figure}

Mostriamo che il problema della clique di taglia fissata è \texttt{NP}-completo, per fare ciò
dobbiamo mostrare che il problema è in \texttt{NP} e che è \texttt{NP-hard}.

\begin{itemize}
    \item \texttt{NP}: Dato un insieme $C$ di vertici, possiamo verificare in tempo polinomiale
    se $I$ è una clique. Il certificato è un \textit{clique} $C$ per $G$ di cardinalità almeno $k$,
    e la verifica consiste nel controllare che ogni coppia di vertici in $C$ sia adiacente e che
    $|C| \geq k$, entrambe le operazioni sono fattibili in tempo polinomiale, infatti il controllo
    viene fatto in tempo $O(|E| \cdot |V|^2)$.
    \item \texttt{NP-hard}: Dimostriamo che $\texttt{Indipendent Set} \leq \texttt{Clique}$.
    
    Per farlo dobbiamo mappare un grafo $G = (V,E)$ e un parametro $k$ in un grafo $G'$ tale che
    $G$ ha un insieme indipendente di cardinalità almeno $k$ se e solo se $G'$ ha una clique di
    cardinalità almeno $k$.

    Notiamo che che se un certo numero di vertici forma un insieme indipendente in $G$, allora
    se tolgo gli archi non presenti in $G$ ed aggiungo gli archi mancanti, ottengo una clique in $G'$.

    Consideriamo un grafo $G = (V,E)$ e un parametro $k$, costruiamo un grafo $G'$ tale che
    $G$ ha un insieme indipendente di cardinalità almeno $k$ se e solo se $G'$ ha una clique di
    cardinalità almeno $k$.

    Per ogni coppia di vertici $u,v \in V$ tali che $u \neq v$ aggiungiamo un arco in $G'$ se e solo
    se $u,v \notin E$.

    Tale costruzione è polinomiale, infatti richiede $O(|V|^2)$ operazioni.
\end{itemize}

\section{Vertex Cover}
Consideriamo il problema del vertex cover.

In input disponiamo di un grafo $G = (V,E)$ non diretto e un parametro $k$, e in output abbiamo
\texttt{yes} se e solo se esiste $W \subseteq V$ tale che $|W| \leq k$ e per ogni arco $(u,v) \cap W 
\neq \emptyset$. Almeno un estremo dell'arco è in $W$.

Per vertex cover intendiamo un insieme di vertici tale che tale insieme riesca a coprire tutti gli
archi del grafo.

\begin{figure}[H]
    \centering 
    \begin{tikzpicture}[node distance={10mm}, thick,
        main/.style = {draw, circle, minimum size=1cm}]
            \node[main, fill = blue!30] (x1) {};
            \node[main, fill = gray!30] (x2) [below left=of x1] {};
            \node[main, fill = gray!30] (x3) [below right=of x1] {};
            \node[main, fill = blue!30] (x4) [below right=of x2] {};
            \node[main, fill = blue!30] (x5) [below right=of x3] {};
            \node[main, fill = blue!30] (x6) [above right=of x3] {};

            \draw (x1) -- (x2);
            \draw (x1) -- (x3);
            \draw (x2) -- (x4);
            \draw (x3) -- (x5);
            \draw (x3) -- (x6);
            \draw (x4) -- (x3);
    \end{tikzpicture}
    \caption{Esempio di vertex cover di cardinalità $4$}
\end{figure}

Mostriamo che il problema del vertex cover è \texttt{NP}-completo, per fare ciò
dobbiamo mostrare che il problema è in \texttt{NP} e che è \texttt{NP-hard}.

\begin{itemize}
    \item \texttt{NP}: Dato un insieme $W$ di vertici, possiamo verificare in tempo polinomiale
    se $W$ è un vertex cover. Il certificato è un \textit{vertex cover} $W$ per $G$ di cardinalità
    almeno $k$, e la verifica consiste nel controllare che ogni arco abbia almeno un estremo in $W$
    e che $|W| \geq k$, entrambe le operazioni sono fattibili in tempo polinomiale, infatti il controllo
    viene fatto in tempo $O(|E| \cdot |W|)$.
    \item \texttt{NP-hard}: Dimostriamo che $\texttt{Indipendent set} \leq \texttt{Vertex Cover}$.

\begin{lemma}
    Dato un grafo $G = (V,E)$ e un sottoinsieme $I$ dei vertici, $I$ è un insieme indipendente
    in $G$ se e solo se $V \setminus I$ è un vertex cover in $G$.
\end{lemma}
    Dato il lemma, possiamo ridurre il problema dell'insieme indipendente al
    problema del vertex cover. Data un'istanza $(G, k)$ del problema dell'insieme indipendente,
    costruiamo un'istanza $(G', k')$ del problema del vertex cover tale che $G$ ha un insieme 
    indipendente di cardinalità almeno $k$ se e solo se $G'$ ha un vertex cover di cardinalità
    al più $k'$.

    In virtù del lemma, possiamo costruire $G'$ a partire da $G$, tale che $G' = G$ e $k' = |V| - k$.
    In tal caso $G$ ha un insieme indipendente di cardinalità almeno $k$ se e solo se $G'$ ha un
    vertex cover di cardinalità al più $k'$.

    Tale costruzione è polinomiale, infatti richiede $O(|V|)$ operazioni.

    Abbiamo quindi dimostrato che il problema del vertex cover è \texttt{NP}-completo.
\end{itemize}

\section{Set Cover}
Consideriamo il problema del set cover.

In input disponiamo di un insieme $U$ di $n$ elementi, una famiglia $\mathcal{S}$ di sottoinsiemi
di $U$ e un parametro $k$, e in output abbiamo \texttt{yes} se e solo se esiste una collezione
$\mathcal{C} \subseteq \mathcal{S}$ tale che $|\mathcal{C}| \leq k$ e $\bigcup_{S \in \mathcal{C}} S = U$.
