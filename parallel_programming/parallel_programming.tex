\documentclass[oneside,a4paper,11pt]{book}
\usepackage[utf8]{inputenc}
\usepackage{svg}
\usepackage[italian]{babel}
\usepackage{float}
\usepackage{fancyvrb}
\usepackage{titling}
\usepackage[margin=1in,footskip=0.25in]{geometry}
\usepackage{listings}
\usepackage[DIV=12,BCOR=2mm,headinclude=true,footinclude=false]{typearea}
\usepackage{color, colortbl,xcolor}
\usepackage[hidelinks]{hyperref}
\usepackage{tcolorbox}
\usepackage{chngcntr}
\usepackage{diagbox}
\usepackage{calc}
\usepackage{amssymb}
\usepackage{subcaption}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{parskip}
\usepackage{cancel}
\usepackage{forest}
\usepackage{listings}
\usepackage{mathrsfs}
\usepackage{enumitem}
\usepackage{makecell}
\usepackage{tikz}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
\usepackage{fancyhdr}
\fancypagestyle{plain}{\fancyhf{}\renewcommand{\headrulewidth}{0pt}}
\pagestyle{fancy}
\fancyhf{}% Clear header/footer
\fancyhead[L]{\nouppercase\leftmark}
\fancyhead[R]{\thepage}
\usetikzlibrary{positioning,shapes.geometric,arrows.meta,matrix,automata,decorations.pathmorphing,patterns,decorations.pathreplacing,shapes.multipart,calc,snakes}
\usetikzlibrary{arrows.meta, backgrounds, chains, positioning, shapes.geometric, shapes.multipart}
\usetikzlibrary{positioning,fit,arrows.meta,backgrounds}
\tcbuselibrary{skins}
\counterwithin{figure}{section}
\usetikzlibrary{arrows,shapes,positioning,arrows.meta}
\usepackage{algorithm2e} % Pacchetto per algoritmi
\tikzset{
    block/.style={
        rectangle,
        draw,
        text width=1.5cm,
        align=center,
        minimum height=0.75cm,
        font=\sffamily
    },
    arrow/.style={-Latex}
}
\usetikzlibrary{calc}
\newcommand\unit[4]   {\draw[fill=#2] (#4) rectangle +(#1);
                       \node[font=\sffamily\bfseries] at ($(#4)+0.5*(#1)$) {#3};
                      }
\newcommand\gpualu    {\unit{ 0.9,0.9 }{green!30}{}}
\newcommand\gpucontrol{\unit{ 0.9,0.4 }{yellow!30}{}}
\newcommand\gpucache  {\unit{ 0.9,0.4 }{red!30}{}}
\newcommand\dram      {\unit{16.9,1.9 }{red!30}{DRAM}}
\newcommand\cpualu    {\unit{ 4.1,2.05}{green!30}{ALU}}
\newcommand\cpucontrol{\unit{ 8.4,4.2 }{yellow!30}{Control}}
\newcommand\cpucache  {\unit{16.9,4.2 }{red!30}{Cache}}

\usetikzlibrary{fit, backgrounds, arrows, calc, decorations.pathmorphing, positioning}

\tikzset{
    snake arrow/.style={
        ->, thick, 
        decorate, 
        decoration={snake, amplitude=.4mm, segment length=2mm, post length=1mm}
    },
    thread/.pic={
        \node[fill=orange,
              label={[anchor=north, name=th]90:Thread (\the\pgfmatrixcurrentcolumn,\the\pgfmatrixcurrentrow)},
              minimum width=2cm,  % ridotta da 3cm
              minimum height=2cm, % ridotta da 2.5cm
              draw] (Th) {};
        \draw[thick] (th.south) edge[snake arrow] ++(-90:10mm);
    },
    block/.pic={
        \node[fill=yellow,
              label={[anchor=north, name=bl]90:Block (\the\pgfmatrixcurrentcolumn,\the\pgfmatrixcurrentrow)},
              minimum width=2cm,  % ridotta da 3cm
              minimum height=2cm, % ridotta da 2.5cm
              draw] (Bl) {};
        \foreach \i in {-4,0,4}
            \draw[thick] ([xshift=\i mm]bl.south) edge[snake arrow] ++(-90:10mm); % ridotta la lunghezza della freccia
    }
}
%Nuovi comandi
\newcommand\myeq{\stackrel{\mathclap{\normalfont\mbox{def}}}{=}}
\newcommand\prodG{\stackrel{\mathclap{\normalfont\mbox{\tiny{G}}}}{\Longrightarrow}}
%asmthm
\newlength{\marginlabelsep}\setlength{\marginlabelsep}{0.5em}
\newtheoremstyle{italicstyle} %% Name
  {} %% <- Space above (empty = default = \topsep = 8.0pt plus 2.0pt minus 4.0pt)
  {} %% <- Space below (empty = default = \topsep = 8.0pt plus 2.0pt minus 4.0pt)
  {\itshape} %% <- Body font
  {} %% <- Indent amount (empty = no indent, \parindent = just that)
  {\bfseries} %% <- Thm head font
  {} %% <- Punctuation after thm head
  {1pt} %% <- Space after thm head (or " " or \newline) (default: 5pt plus 1pt minus 1pt)
  {\vtop to 0pt{\llap{\thmname{#1}\hskip\marginlabelsep}
                \llap{\thmnumber{#2}\hskip\marginlabelsep}}\thmnote{#3\\}%
  }
\newtheoremstyle{normStyle} %% Name
  {} %% <- Space above (empty = default = \topsep = 8.0pt plus 2.0pt minus 4.0pt)
  {} %% <- Space below (empty = default = \topsep = 8.0pt plus 2.0pt minus 4.0pt)
  {\normalfont} %% <- Body font
  {} %% <- Indent amount (empty = no indent, \parindent = just that)
  {\bfseries} %% <- Thm head font
  {} %% <- Punctuation after thm head
  {1pt} %% <- Space after thm head (or " " or \newline) (default: 5pt plus 1pt minus 1pt)
  {\vtop to 0pt{\llap{\thmname{#1}\hskip\marginlabelsep}
                \llap{\thmnumber{#2}\hskip\marginlabelsep}}\thmnote{#3\\}%
  }
\theoremstyle{italicstyle}
\newtheorem{corollary}{Corollario}[section]
\newtheorem{notazione}{Notazione}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{definizione}{Definizione}[section]
\newtheorem{nota}{Nota}[section]
\newtheorem{exercise}{Esercizio}[section]
\theoremstyle{normStyle}
\newtheorem{exmp}{Esempio}[section]
\newtheorem{theorem}{Teorema}[section]
\newtheorem{proposizione}{Proposizione}[section]
\tcbuselibrary{listings,skins}
\newtcblisting{mylisting}[2][]{
    arc=0pt, outer arc=0pt,
    listing only, 
    title=#2,
    #1,
    listing options= {escapechar=|}
}
\newcommand{\myboxedtext}[2][rectangle,draw]{%
    \tikz[baseline=-0.6ex] \node [#1]{#2};}%

    \newcommand{\lstfont}[1]{\color{#1}\scriptsize\ttfamily}

    \lstset{
        language=[ANSI]C++,
        showstringspaces=false,
        backgroundcolor=\color{white!90},
        basicstyle=\lstfont{black},
        identifierstyle=\lstfont{purple},
        keywordstyle=\lstfont{magenta!40},
        numberstyle=\lstfont{white},
        stringstyle=\lstfont{cyan},
        commentstyle=\lstfont{yellow!30},
        emph={
            cudaMalloc, cudaFree,
            __global__, __shared__, __device__, __host__,
            __syncthreads,
        },
        emphstyle={\lstfont{green!60!white}},
        breaklines=true
    }
\usetikzlibrary{arrows.meta, 
    bending,
    calc, chains,
    positioning
    }
\newcommand{\cube}[7]% position (center), size, color, front edges (1/0), back edges (1/0),
{%                      label, y shift for the label
  \begin{scope}[shift={#1},scale=0.5]
    \draw[fill=#3] (-#2,-#2,-#2) -- (-#2,-#2, #2) -- ( #2,-#2, #2) --
                   ( #2, #2, #2) -- ( #2, #2,-#2) -- (-#2, #2,-#2)  -- cycle;
    \ifnum #4 = 1% if we need front edges
      \draw ( #2,-#2,-#2) -- (-#2,-#2,-#2);
      \draw ( #2,-#2,-#2) -- ( #2, #2,-#2);
      \draw ( #2,-#2,-#2) -- ( #2,-#2, #2);    
    \fi
    \ifnum #5 = 1% if we need back edges
      \draw (-#2, #2, #2) -- ( #2, #2, #2);
      \draw (-#2, #2, #2) -- (-#2,-#2, #2);
      \draw (-#2, #2, #2) -- (-#2, #2,-#2);
    \fi
    \node[blue] at (0,-2*#7,0) {#6};
  \end{scope}
}
%%======================================================================
\usepackage{xcolor}
\usepackage{listings}

\usepackage{color}
\definecolor{backgroundColour}{RGB}{245,245,245}
\definecolor{mygreen}{RGB}{28,172,0} % Green for comments
\definecolor{mGray}{RGB}{128,128,128}
\definecolor{mPurple}{RGB}{128,0,128}
\definecolor{babyblue}{RGB}{137,207,240}
\definecolor{green}{RGB}{0,128,0}

% Define a custom color
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\definecolor{codegreen}{rgb}{0,0.6,0}

% Define a custom style
\lstdefinestyle{myStyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    keepspaces=true,                 
    numbers=left,       
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
}
\usetikzlibrary{matrix,arrows,decorations.pathmorphing}
% l' unite
\newcommand{\myunit}{1 cm}
\tikzset{
    node style sp/.style={draw,circle,minimum size=\myunit},
    node style ge/.style={circle,minimum size=\myunit},
    arrow style mul/.style={draw,sloped,midway,fill=white},
    arrow style plus/.style={midway,sloped,fill=white},
}

% Use \lstset to make myStyle the global default
\lstset{style=myStyle}
%%======================================================================
\title{Programmazione Parallela}
\author{\textit{Alessio Gjergji}}
\date{}
\begin{document}
\begin{titlingpage}
  \centering
  \vspace*{\stretch{1}}
  \huge
  \textbf{\thetitle}\\[0.5cm]
  \normalsize
  Corso tenuto dal Professor Nicola Bombieri\\[0.5cm]
  UniversitÃ  di Verona\\[1cm]
  \large
  \theauthor\\[0.5cm]
  \vspace{\stretch{2}}
\end{titlingpage}
\tableofcontents
\input{introduction.tex}
\input{metodiprogrammazione.tex}
\input{performance.tex}
\input{prospettiva_prog_parallela.tex}

\input{gpu.tex}
\end{document}
